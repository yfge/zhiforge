# 自动知乎回答（全流程）

## 任务
自动完成知乎回答全流程：搜索问题 → 去重 → 匹配博客 → 撰写文章 → 发布。

**重要约束：**
- 全程自动执行，禁止使用 AskUserQuestion 询问用户
- 禁止中途暂停等待确认
- 遇到问题自行决策或跳过，不要问用户

---

## 第一步：获取已回答问题（去重用）

1. 使用 Chrome MCP 打开创作中心文章列表：`https://www.zhihu.com/creator/manage/creation/article`
2. 获取已发布文章的标题列表，记录下来用于去重
3. 同时检查回答列表：`https://www.zhihu.com/creator/manage/creation/answer`
4. 合并成"已回答问题关键词列表"

---

## 第二步：获取待回答问题

1. 读取 `claude.md` 了解作者专业领域
2. 使用 Chrome MCP 打开知乎邀请页面：`https://www.zhihu.com/creator/featured-question/invited`
3. 获取问题列表，筛选高匹配度问题：
   - AI 编程 / vibe-coding / Claude Code
   - 工程化实践 / Docker / Git
   - 后端开发 / 性能优化
4. **排除已回答过的问题**（标题相似度 > 80% 视为已回答）
5. 选择**第一个未回答的高匹配度问题**（回答数少、关注多的优先）
6. 如果没有可回答的问题，直接输出"暂无新的适合回答的问题"并结束

---

## 第二步：匹配博客内容

1. 读取 `.claude/settings.json` 获取 `blog_path` 配置
2. 搜索博客目录（使用配置中的路径）
3. 根据问题关键词匹配相关文章
4. 读取匹配的博客文章内容

---

## 第三步：撰写文章

根据博客内容，撰写知乎文章：

**写作风格：**
- 开门见山，先给结论
- 用实际案例说话（引用博客中的项目经验）
- 技术内容要落地可执行
- 代码块使用 ```bash 或 ```python 标注语言
- 列表使用 - 或 1. 2. 3.
- 重点用 **加粗** 或 `代码格式`
- 结尾引导关注公众号（使用 settings.json 中的 author.wechat_official）或博客（使用 blog_url）

**将文章写入临时文件：**
```
/private/tmp/claude-501/.../scratchpad/zhihu-article.md
```

---

## 第四步：发布文章

### 4.1 打开专栏写作页面
**必须使用：** `https://zhuanlan.zhihu.com/write`

> ⚠️ 坑1: 直接访问问题页面会触发 40362 反爬虫

### 4.2 导入 Markdown 文件
1. 点击工具栏"导入"按钮
2. 点击"导入文档"
3. 使用 `upload_file` 上传 markdown 文件
4. 等待"文档导入中，请稍等..."消失

> ⚠️ 坑2: 不能直接 fill 内容，markdown 语法会显示为纯文本
> ⚠️ 坑3: 导入是追加不是替换，必须打开新的 write 页面

### 4.3 填写标题
导入完成后，fill 标题框

> ⚠️ 坑4: 标题可能被污染，导入后重新 fill 正确标题

### 4.4 设置投稿至问题
1. 点击"投稿至问题"下拉框
2. 在搜索框输入问题关键词
3. 点击"搜索"按钮
4. 点击目标问题的"选择"按钮
5. 点击"确定"或按 ESC 关闭对话框

> ⚠️ 坑5: 对话框难关闭，用 `press_key("Escape")`
> ⚠️ 坑6: 搜索框是 combobox，先 click 聚焦再输入

### 4.5 发布
1. 点击"发布"按钮
2. 等待按钮变成"发布中..."
3. 等待跳转（URL 包含 `just_published=1` 表示成功）

> ⚠️ 坑7: 发布后可能触发 40362，但 URL 显示成功就是成功
> ⚠️ 坑8: 话题添加可能超时，跳过不影响发布

### 4.6 确认发布
访问创作中心确认：`https://www.zhihu.com/creator/manage/creation/article`

---

## 输出

完成后输出：
```
✅ 发布成功

问题：[问题标题]
文章：[文章标题]
链接：https://zhuanlan.zhihu.com/p/xxxxx
参考博客：[博客文件名]
```

---

## 注意事项

- **禁止使用 AskUserQuestion**，全程自动决策
- **禁止中途暂停**，遇到问题自行处理或跳过
- 保持"老拐"风格：务实、不油腻、有干货
- 如果没有高匹配度问题，输出"暂无新的适合回答的问题"并结束
- 如果博客中没有相关内容，基于专业经验撰写
- 如果某步骤失败（如对话框超时），用 ESC 关闭后继续下一步
- 发布失败时重试一次，仍失败则输出错误信息并结束
